(function(n,t,i,r){"use strict";var f=function(){return this.init.apply(this,arguments)},u;f.prototype={defaults:{onstatechange:function(){},ondragend:function(){},onbarclicked:function(){},isRange:!1,showLabels:!0,showScale:!0,step:1,format:"%s",theme:"theme-green",width:300,disable:!1,snap:!1},template:'<div class="slider-container">\t\t\t<div class="back-bar">                <div class="selected-bar"><\/div>                <div class="pointer low"><\/div><div class="pointer-label low">123456<\/div>                <div class="pointer high"><\/div><div class="pointer-label high">456789<\/div>                <div class="clickable-dummy"><\/div>            <\/div>            <div class="scale"><\/div>\t\t<\/div>',init:function(t,i){this.options=n.extend({},this.defaults,i);this.inputNode=n(t);this.options.value=this.inputNode.val()||(this.options.isRange?this.options.from+","+this.options.from:""+this.options.from);this.domNode=n(this.template);this.domNode.addClass(this.options.theme);this.inputNode.after(this.domNode);this.domNode.on("change",this.onChange);this.pointers=n(".pointer",this.domNode);this.lowPointer=this.pointers.first();this.highPointer=this.pointers.last();this.labels=n(".pointer-label",this.domNode);this.lowLabel=this.labels.first();this.highLabel=this.labels.last();this.scale=n(".scale",this.domNode);this.bar=n(".selected-bar",this.domNode);this.clickableBar=this.domNode.find(".clickable-dummy");this.interval=this.options.to-this.options.from;this.render()},render:function(){if(this.inputNode.width()!==0||this.options.width)this.options.width=this.options.width||this.inputNode.width(),this.domNode.width(this.options.width),this.inputNode.hide();else{console.log("jRange : no width found, returning");return}this.isSingle()&&(this.lowPointer.hide(),this.lowLabel.hide());this.options.showLabels||this.labels.hide();this.attachEvents();this.options.showScale&&this.renderScale();this.setValue(this.options.value)},isSingle:function(){return typeof this.options.value=="number"?!0:this.options.value.indexOf(",")!==-1||this.options.isRange?!1:!0},attachEvents:function(){this.clickableBar.click(n.proxy(this.barClicked,this));this.pointers.on("mousedown touchstart",n.proxy(this.onDragStart,this));this.pointers.bind("dragstart",function(n){n.preventDefault()})},onDragStart:function(t){if(!this.options.disable&&(t.type!=="mousedown"||t.which===1)){t.stopPropagation();t.preventDefault();var r=n(t.target);this.pointers.removeClass("last-active");r.addClass("focused last-active");this[(r.hasClass("low")?"low":"high")+"Label"].addClass("focused");n(i).on("mousemove.slider touchmove.slider",n.proxy(this.onDrag,this,r));n(i).on("mouseup.slider touchend.slider touchcancel.slider",n.proxy(this.onDragEnd,this))}},onDrag:function(n,t){t.stopPropagation();t.preventDefault();t.originalEvent.touches&&t.originalEvent.touches.length?t=t.originalEvent.touches[0]:t.originalEvent.changedTouches&&t.originalEvent.changedTouches.length&&(t=t.originalEvent.changedTouches[0]);var i=t.clientX-this.domNode.offset().left;this.domNode.trigger("change",[this,n,i])},onDragEnd:function(){this.pointers.removeClass("focused").trigger("rangeslideend");this.labels.removeClass("focused");n(i).off(".slider");this.options.ondragend.call(this,this.options.value)},barClicked:function(n){var t;if(!this.options.disable){if(t=n.pageX-this.clickableBar.offset().left,this.isSingle())this.setPosition(this.pointers.last(),t,!0,!0);else{var i=Math.abs(parseFloat(this.pointers.first().css("left"),10)),e=this.pointers.first().width()/2,o=Math.abs(parseFloat(this.pointers.last().css("left"),10)),s=this.pointers.first().width()/2,r=Math.abs(i-t+e),u=Math.abs(o-t+s),f;f=r==u?t<i?this.pointers.first():this.pointers.last():r<u?this.pointers.first():this.pointers.last();this.setPosition(f,t,!0,!0)}this.options.onbarclicked.call(this,this.options.value)}},onChange:function(n,t,i,r){var u,f,e;u=0;f=t.domNode.width();t.isSingle()||(u=i.hasClass("high")?parseFloat(t.lowPointer.css("left"))+t.lowPointer.width()/2:0,f=i.hasClass("low")?parseFloat(t.highPointer.css("left"))+t.highPointer.width()/2:t.domNode.width());e=Math.min(Math.max(r,u),f);t.setPosition(i,e,!0)},setPosition:function(n,t,i,r){var f,c,h=parseFloat(this.lowPointer.css("left")),o=parseFloat(this.highPointer.css("left"))||0,u=this.highPointer.width()/2,s,e;if(i||(t=this.prcToPx(t)),this.options.snap){if(s=this.correctPositionForSnap(t),s===-1)return;t=s}n[0]===this.highPointer[0]?o=Math.round(t-u):h=Math.round(t-u);n[r?"animate":"css"]({left:Math.round(t-u)});this.isSingle()?f=0:(f=h+u,c=o+u);e=Math.round(o+u-f);this.bar[r?"animate":"css"]({width:Math.abs(e),left:e>0?f:f+e});this.showPointerValue(n,t,r);this.isReadonly()},correctPositionForSnap:function(n){var r=this.positionToValue(n)-this.options.from,t=this.options.width/(this.interval/this.options.step),i=r/this.options.step*t;return n<=i+t/2&&n>=i-t/2?i:-1},setValue:function(n){var t=n.toString().split(","),i;t[0]=Math.min(Math.max(t[0],this.options.from),this.options.to)+"";t.length>1&&(t[1]=Math.min(Math.max(t[1],this.options.from),this.options.to)+"");this.options.value=n;i=this.valuesToPrc(t.length===2?t:[0,t[0]]);this.isSingle()?this.setPosition(this.highPointer,i[1]):(this.setPosition(this.lowPointer,i[0]),this.setPosition(this.highPointer,i[1]))},renderScale:function(t){for(var r=t||this.options.scale||[this.options.from,this.options.to],f=Math.round(1e3/(r.length-1))/10,u="",i=0;i<r.length;i++)u+='<span style="left: '+i*f+'%">'+(r[i]!="|"?"<ins>"+r[i]+"<\/ins>":"")+"<\/span>";this.scale.html(u);setTimeout(function(){n("ins",this.scale).each(function(){n(this).css({marginLeft:-(n(this).outerWidth()/2)})})},100)},getBarWidth:function(){var n=this.options.value.split(",");return n.length>1?parseFloat(n[1])-parseFloat(n[0]):parseFloat(n[0])},showPointerValue:function(t,i,u){var o=n(".pointer-label",this.domNode)[t.hasClass("low")?"first":"last"](),f,e=this.positionToValue(i),s,h,c;n.isFunction(this.options.format)?(s=this.isSingle()?r:t.hasClass("low")?"low":"high",f=this.options.format(e,s)):f=this.options.format.replace("%s",e);h=o.html(f).width();c=i-h/2;o[u?"animate":"css"]({left:c});this.setInputValue(t,e)},valuesToPrc:function(n){var t=(parseFloat(n[0])-parseFloat(this.options.from))*100/this.interval,i=(parseFloat(n[1])-parseFloat(this.options.from))*100/this.interval;return[t,i]},prcToPx:function(n){return this.domNode.width()*n/100},isDecimal:function(){return(this.options.value.toString()+this.options.from.toString()+this.options.to.toString()).indexOf(".")===-1?!1:!0},positionToValue:function(n){var i=n/this.domNode.width()*this.interval,t;if(i=parseFloat(i,10)+parseFloat(this.options.from,10),this.isDecimal()){if(t=Math.round(Math.round(i/this.options.step)*this.options.step*100)/100,t!==0)for(t=""+t,t.indexOf(".")===-1&&(t=t+".");t.length-t.indexOf(".")<3;)t=t+"0";else t="0.00";return t}return Math.round(i/this.options.step)*this.options.step},setInputValue:function(n,t){if(this.isSingle())this.options.value=t.toString();else{var i=this.options.value.split(",");this.options.value=n.hasClass("low")?t+","+i[1]:i[0]+","+t}this.inputNode.val()!==this.options.value&&(this.inputNode.val(this.options.value).trigger("change"),this.options.onstatechange.call(this,this.options.value))},getValue:function(){return this.options.value},getOptions:function(){return this.options},getRange:function(){return this.options.from+","+this.options.to},isReadonly:function(){this.domNode.toggleClass("slider-readonly",this.options.disable)},disable:function(){this.options.disable=!0;this.isReadonly()},enable:function(){this.options.disable=!1;this.isReadonly()},toggleDisable:function(){this.options.disable=!this.options.disable;this.isReadonly()},updateRange:function(n,t,i){var r=n.toString().split(",");this.options.from=r[0];this.options.to=r[1];this.interval=parseInt(r[1])-parseInt(r[0]);t?this.setValue(t):this.setValue(this.getValue());i&&this.renderScale(i)}};u="jRange";n.fn[u]=function(i){var e=arguments,r;return this.each(function(){var s=n(this),o=n.data(this,"plugin_"+u),h=typeof i=="object"&&i;o||(s.data("plugin_"+u,o=new f(this,h)),n(t).resize(function(){o.setValue(o.getValue())}));typeof i=="string"&&(r=o[i].apply(o,Array.prototype.slice.call(e,1)))}),r||this}})(jQuery,window,document)