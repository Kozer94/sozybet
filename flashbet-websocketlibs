function webSocketComm(n,t,i){this.server=n;this.port=t;this.path=i;this.hub=null;this.ConnectTimeout=null;var r=this,u=r;$.connection.hub.url=WEB_SOCKET_URL_START+n+":"+t+"/"+i;this.init=function(){hub=$.connection.server;hub.client.onMessageReceive=function(n){WebSocketClient.onReceive({data:n})};$.connection.hub.error(function(n){console.log("error: "+n)});$.connection.hub.reconnected(function(){console.log("reconnected")});$.connection.hub.disconnected(function(){u&&(console.log("Hub Disconnected..."),r.ConnectTimeout&&(clearTimeout(r.ConnectTimeout),r.ConnectTimeout=null),r.ConnectTimeout=setTimeout(r.Connect,5e3))});$.connection.hub.stateChanged(function(n){typeof $.signalR=="function"&&(n.newState===$.signalR.connectionState.reconnecting?console.log("Reconnecting..."):n.newState===$.signalR.connectionState.connected?console.log("The server is online"):n.newState===$.signalR.connectionState.connecting?console.log("Connecting..."):n.newState===$.signalR.connectionState.disconnected&&console.log("Disconnected..."))});this.Connect()};this.Connect=function(){r.ConnectTimeout&&(clearTimeout(r.ConnectTimeout),r.ConnectTimeout=null);console.log("Start connecting ...");$.connection.hub.start().done(function(){console.log("start")}).fail(function(){r.ConnectTimeout=setTimeout(r.Connect,5e3)})};this.onReceive=function(){};this.Send=function(n){this.SocketLive()?hub.server.send(n).fail(function(){}):console.log(n)};this.SendPacket=function(n){if(this.SocketLive()){var t=n.AsString();return hub.server.send(t).fail(function(){}),!0}return console.log("Error - socket is not live."),!1};this.Close=function(){u=null;$.connection.hub.stop()};this.SocketLive=function(){return!isNothing($.connection)&&!isNothing($.signalR)&&$.connection.hub&&$.connection.hub.state===$.signalR.connectionState.connected}}function InitWebSocketComm(){WebScoketActions=[];WebScoketActions.ServerGreetingPacket=ServerGreetingPacketAction;WebScoketActions.PongPacket=PongPacketAction;WebScoketActions.ChatMessagePacket=ChatPacketAction;WebScoketActions.MarkChatMessagesAsReadedResponsePacket=MarkChatMessagesAsReadedResponsePacketAction;WebScoketActions.ChatUsersListResponsePacket=ChatUsersListPacketAction;WebScoketActions.ChatInfoPacket=ChatInfoPacketAction;WebScoketActions.RedirectClientToMaintenancePagePacket=RedirectClientToMaintenancePagePacketAction;WebScoketActions.LogOutRequestPacket=LogOutRequestPacketAction;WebSocketClient=new webSocketComm(WEB_SOCKET_SERVER,WEB_SOCKET_PORT,WEB_SOCKET_PATH,CLIENT_TYPE);WebSocketClient.init();WebSocketClient.onReceive=function(n){messageReceived(n.data)}}function LogOutRequestPacketAction(){var n=ROOT+"Account/Logout";window.location.replace(n)}function RedirectClientToMaintenancePagePacketAction(){var n=ROOT+"Account/Logout";window.location.replace(n)}function ServerGreetingPacketAction(n){var t,i,r;console.log(n.Packet.Message);t=new SubscribeClientPacket(WEB_SERVER_NAME,SESSION_ID,USER_ID,USERNAME,CLIENT_TYPE);WebSocketClient.SendPacket(t);i=getBrowserInfo();r=new ClientInfoPacket(window.location.href,i,WEB_SOCKET_APP);WebSocketClient.SendPacket(r);WebSocketClient.SendPacket(new SubscribeToChatRequestPacket)}function PongPacketAction(){var n=new PingPacket;WebSocketClient.SendPacket(n)}function ChatPacketAction(n){newChatMessage(n.Packet)}function MarkChatMessagesAsReadedResponsePacketAction(n){markChatMessagesAsReadedResponse(n.Packet)}function ChatUsersListPacketAction(n){n.Packet.List.forEach(function(n){addUserToChat(n)});getUnreadMessages()}function ChatInfoPacketAction(n){var t=n.Packet.UnreadMessagesCount;typeof setUnreadMessagesCount=="function"&&setUnreadMessagesCount(t)}function messageReceived(n){var i=jQuery.parseJSON(n),r=GetPacketFromJSON(i),t;r!=null?(t=r.GetType(),WebScoketActions[t]!=null&&WebScoketActions[t](i)):console.error("Recived not valid packet from Server")}function getBrowserInfo(){var n="",t="";return bowser.mobile&&(n+=", mobile"),bowser.tablet&&(n+=", tablet"),bowser.android&&(n+=", android"),bowser.iphone&&(n+=", iPhone"),bowser.ipad&&(n+=", iPad"),bowser.ios&&(n+=", iOS"),bowser.windows&&(n+=", windows"),bowser.mac&&(n+=", mac"),bowser.osversion&&(n+=", OS ver="+bowser.osversion),bowser.version&&(t=" v="+bowser.version),bowser.name+t+n}var WEB_SOCKET_SERVER="135.125.160.26",WEB_SOCKET_PORT="80",WEB_SOCKET_PATH="probetliveodds",WEB_SOCKET_APP="Client",CLIENT_TYPE="0",PICTURE_UPLOAD_URL="http://sesbetadmin.skydesignstudio.rs/Picture/Upload",WEB_SOCKET_URL_START="http://",WebScoketActions,ClientSubscription;(function(n){"use strict";function r(t,i){return function(){i.apply(t,n.makeArray(arguments))}}function i(t,i){var e,u,f,o,s;for(e in t)if(t.hasOwnProperty(e)){if(u=t[e],!u.hubName)continue;s=i?u.on:u.off;for(f in u.client)if(u.client.hasOwnProperty(f)){if(o=u.client[f],!n.isFunction(o))continue;s.call(u,f,r(u,o))}}}if(typeof n.signalR!="function")throw new Error("SignalR: SignalR is not loaded. Please ensure jquery.signalR-x.js is referenced before ~/signalr/js.");var t=n.signalR;n.hubConnection.prototype.createHubProxies=function(){var t={};return this.starting(function(){i(t,!0);this._registerSubscribedHubs()}).disconnected(function(){i(t,!1)}),t.server=this.createHubProxy("server"),t.server.client={},t.server.server={send:function(){return t.server.invoke.apply(t.server,n.merge(["send"],n.makeArray(arguments)))}},t};t.hub=n.hubConnection("/"+WEB_SOCKET_PATH,{useDefaultPath:!1});n.extend(t,t.hub.createHubProxies())})(window.jQuery,window);WebScoketActions=null;ClientSubscription=0;InitWebSocketComm()